[2021-12-16:17:15:04:INFO:sockeye.utils:log_sockeye_version] Sockeye: 3.0.4, commit 8e5033be2a2f09d935c682f33703eff34cf8b3f4, path /home/cluster/zifjia/.local/lib/python3.8/site-packages/sockeye/__init__.py
[2021-12-16:17:15:04:INFO:sockeye.utils:log_mxnet_version] MXNet: 2.0.0 (/home/cluster/zifjia/.local/lib/python3.8/site-packages/mxnet/__init__.py)
[2021-12-16:17:15:04:INFO:sockeye.utils:log_torch_version] PyTorch: 1.10.0+cu102 (/home/cluster/zifjia/.local/lib/python3.8/site-packages/torch/__init__.py)
[2021-12-16:17:15:04:INFO:sockeye.utils:log_basic_info] Command: /home/cluster/zifjia/.local/lib/python3.8/site-packages/sockeye/train.py --prepared-data data_sockeye -vs data_reverse/dev.spm.spoken -vt data_reverse/dev.symbol --output models/sockeye_spoken2symbol --overwrite-output --weight-tying-type trg_softmax --label-smoothing 0.2 --optimized-metric perplexity --checkpoint-interval 4000 --max-num-checkpoint-not-improved 20 --embed-dropout 0.5 --transformer-dropout-attention 0.5 --initial-learning-rate 0.0001 --learning-rate-reduce-factor 0.7 --learning-rate-reduce-num-not-improved 5 --decode-and-evaluate -1 --keep-last-params 1 --cache-last-best-params 1 --device-id 0 --disable-device-locking --seed 42
[2021-12-16:17:15:04:INFO:sockeye.utils:log_basic_info] Arguments: Namespace(allow_missing_params=False, amp=False, apex_amp=False, batch_sentences_multiple_of=8, batch_size=4096, batch_type='word', bucket_scaling=False, bucket_width=8, cache_last_best_params=1, cache_metric='perplexity', cache_strategy='best', checkpoint_improvement_threshold=0.0, checkpoint_interval=4000, config=None, decode_and_evaluate=-1, decode_and_evaluate_device_id=None, decoder='transformer', device_id=0, device_ids=[-1], disable_device_locking=True, dist=False, dry_run=False, dtype='float32', embed_dropout=(0.5, 0.5), encoder='transformer', env=None, fixed_param_names=[], fixed_param_strategy=None, gradient_clipping_threshold=1.0, gradient_clipping_type='none', horovod=False, ignore_extra_params=False, initial_learning_rate=0.0001, keep_initializations=False, keep_last_params=1, kvstore='device', label_smoothing=0.2, label_smoothing_impl='mxnet', learning_rate_reduce_factor=0.7, learning_rate_reduce_num_not_improved=5, learning_rate_scheduler_type='plateau-reduce', learning_rate_t_scale=1.0, learning_rate_warmup=0, length_task=None, length_task_layers=1, length_task_weight=1.0, lhuc=None, lock_dir='/tmp', loglevel='INFO', loglevel_secondary_workers='INFO', loss='cross-entropy-without-softmax-output', max_checkpoints=None, max_num_checkpoint_not_improved=20, max_num_epochs=None, max_samples=None, max_seconds=None, max_seq_len=(95, 95), max_updates=None, min_num_epochs=None, min_samples=None, min_updates=None, momentum=0.0, no_bucketing=False, no_hybridization=False, no_logfile=False, num_embed=(None, None), num_layers=(6, 6), num_words=(0, 0), optimized_metric='perplexity', optimizer='adam', optimizer_betas=(0.9, 0.999), optimizer_eps=1e-08, optimizer_params=None, output='models/sockeye_spoken2symbol', overwrite_output=True, pad_vocab_to_multiple_of=8, params=None, prepared_data='data_sockeye', quiet=False, quiet_secondary_workers=False, seed=42, shared_vocab=False, source=None, source_factor_vocabs=[], source_factors=[], source_factors_combine=[], source_factors_num_embed=[], source_factors_share_embedding=[], source_factors_use_source_vocab=[], source_vocab=None, stop_training_on_decoder_failure=False, target=None, target_factor_vocabs=[], target_factors=[], target_factors_combine=[], target_factors_num_embed=[], target_factors_share_embedding=[], target_factors_use_target_vocab=[], target_factors_weight=[1.0], target_vocab=None, transformer_activation_type=('relu', 'relu'), transformer_attention_heads=(8, 8), transformer_dropout_act=(0.1, 0.1), transformer_dropout_attention=(0.5, 0.5), transformer_dropout_prepost=(0.1, 0.1), transformer_feed_forward_num_hidden=(2048, 2048), transformer_feed_forward_use_glu=False, transformer_model_size=(512, 512), transformer_positional_embedding_type='fixed', transformer_postprocess=('dr', 'dr'), transformer_preprocess=('n', 'n'), update_interval=1, use_cpu=False, validation_source='data_reverse/dev.spm.spoken', validation_source_factors=[], validation_target='data_reverse/dev.symbol', validation_target_factors=[], weight_decay=0.0, weight_init='xavier', weight_init_scale=3.0, weight_init_xavier_factor_type='avg', weight_init_xavier_rand_type='uniform', weight_tying_type='trg_softmax', word_min_count=(1, 1))
[2021-12-16:17:15:04:INFO:__main__:train] Adjusting maximum length to reserve space for a BOS/EOS marker. New maximum length: (96, 96)
[2021-12-16:17:15:04:WARNING:sockeye.utils:expand_requested_device_ids] Sockeye currently does not respect CUDA_VISIBLE_DEVICE settings when locking GPU devices.
[2021-12-16:17:15:04:INFO:sockeye.utils:_expand_requested_device_ids] Attempting to acquire 1 GPUs of 1 GPUs.
[2021-12-16:17:15:04:INFO:__main__:train] Training Device(s): gpu(0)
[2021-12-16:17:15:04:INFO:sockeye.utils:seed_rngs] Random seed: 42
[2021-12-16:17:15:05:INFO:sockeye.utils:seed_rngs] PyTorch seed: 42
[2021-12-16:17:15:05:INFO:sockeye.data_io:get_prepared_data_iters] ===============================
[2021-12-16:17:15:05:INFO:sockeye.data_io:get_prepared_data_iters] Creating training data iterator
[2021-12-16:17:15:05:INFO:sockeye.data_io:get_prepared_data_iters] ===============================
[2021-12-16:17:15:05:INFO:sockeye.vocab:vocab_from_json] Vocabulary (2000 words) loaded from "data_sockeye/vocab.src.0.json"
[2021-12-16:17:15:05:INFO:sockeye.vocab:vocab_from_json] Vocabulary (12224 words) loaded from "data_sockeye/vocab.trg.0.json"
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:log] Tokens: source 2075941 target 2225438
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:log] Number of <unk> tokens: source 0 target 0
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:log] Vocabulary coverage: source 100% target 100%
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:log] 111529 sequences across 26 buckets
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:log] 417 sequences did not fit into buckets and were discarded
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (16, 16): 81219 samples in 152 batches of 536, ~4114.7 target tokens/batch, trg/src length ratio: 0.57 (+-0.21)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (24, 24): 14620 samples in 39 batches of 376, ~4105.1 target tokens/batch, trg/src length ratio: 0.64 (+-0.40)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (32, 32): 1193 samples in 5 batches of 256, ~4088.3 target tokens/batch, trg/src length ratio: 0.86 (+-0.74)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (40, 40): 457 samples in 4 batches of 136, ~4131.5 target tokens/batch, trg/src length ratio: 1.55 (+-0.87)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (48, 48): 408 samples in 5 batches of 96, ~4070.6 target tokens/batch, trg/src length ratio: 1.87 (+-0.80)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (56, 56): 628 samples in 8 batches of 80, ~4090.4 target tokens/batch, trg/src length ratio: 1.78 (+-0.72)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (64, 64): 1030 samples in 15 batches of 72, ~4284.3 target tokens/batch, trg/src length ratio: 1.81 (+-0.68)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (72, 72): 1224 samples in 20 batches of 64, ~4326.4 target tokens/batch, trg/src length ratio: 1.85 (+-0.65)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (80, 80): 1199 samples in 22 batches of 56, ~4235.8 target tokens/batch, trg/src length ratio: 1.95 (+-0.71)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (88, 88): 1150 samples in 24 batches of 48, ~4034.3 target tokens/batch, trg/src length ratio: 2.08 (+-0.77)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (96, 96): 1259 samples in 27 batches of 48, ~4431.2 target tokens/batch, trg/src length ratio: 2.19 (+-0.77)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (104, 104): 1170 samples in 30 batches of 40, ~4009.0 target tokens/batch, trg/src length ratio: 2.24 (+-0.76)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (112, 112): 1106 samples in 28 batches of 40, ~4330.3 target tokens/batch, trg/src length ratio: 2.30 (+-0.86)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (120, 120): 1014 samples in 32 batches of 32, ~3725.0 target tokens/batch, trg/src length ratio: 2.38 (+-0.93)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (128, 128): 916 samples in 29 batches of 32, ~3976.0 target tokens/batch, trg/src length ratio: 2.41 (+-1.03)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (136, 136): 731 samples in 23 batches of 32, ~4239.8 target tokens/batch, trg/src length ratio: 2.47 (+-1.19)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (144, 144): 552 samples in 18 batches of 32, ~4495.0 target tokens/batch, trg/src length ratio: 2.45 (+-0.98)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (152, 152): 498 samples in 21 batches of 24, ~3559.2 target tokens/batch, trg/src length ratio: 2.51 (+-1.14)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (160, 160): 361 samples in 16 batches of 24, ~3738.7 target tokens/batch, trg/src length ratio: 2.74 (+-1.65)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (168, 168): 263 samples in 11 batches of 24, ~3943.0 target tokens/batch, trg/src length ratio: 2.63 (+-1.59)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (176, 176): 213 samples in 9 batches of 24, ~4133.9 target tokens/batch, trg/src length ratio: 2.70 (+-1.37)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (184, 184): 145 samples in 7 batches of 24, ~4300.8 target tokens/batch, trg/src length ratio: 3.28 (+-2.51)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (192, 192): 95 samples in 4 batches of 24, ~4508.5 target tokens/batch, trg/src length ratio: 3.63 (+-3.17)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (200, 200): 68 samples in 3 batches of 24, ~4699.4 target tokens/batch, trg/src length ratio: 3.42 (+-2.62)
[2021-12-16:17:15:05:INFO:sockeye.data_io_pt:describe_data_and_buckets] Bucket (201, 201): 10 samples in 1 batches of 48, ~9648.0 target tokens/batch, trg/src length ratio: 2.25 (+-0.60)
[2021-12-16:17:15:05:INFO:sockeye.data_io:_load_shard] Loading shard data_sockeye/shard.00000.
[2021-12-16:17:15:05:INFO:sockeye.data_io:get_validation_data_iter] =================================
[2021-12-16:17:15:05:INFO:sockeye.data_io:get_validation_data_iter] Creating validation data iterator
[2021-12-16:17:15:05:INFO:sockeye.data_io:get_validation_data_iter] =================================
[2021-12-16:17:15:05:INFO:sockeye.data_io:analyze_sequence_lengths] 1137 sequences of maximum length (201, 201) in '/net/cephfs/home/zifjia/signwriting-translation/data_reverse/dev.spm.spoken' and '/net/cephfs/home/zifjia/signwriting-translation/data_reverse/dev.symbol'.
[2021-12-16:17:15:05:INFO:sockeye.data_io:analyze_sequence_lengths] Mean training target/source length ratio: 0.79 (+-0.76)
[2021-12-16:17:15:05:INFO:sockeye.data_io:log] Tokens: source 20965 target 22274
[2021-12-16:17:15:05:INFO:sockeye.data_io:log] Number of <unk> tokens: source 0 target 24
[2021-12-16:17:15:05:INFO:sockeye.data_io:log] Vocabulary coverage: source 100% target 100%
[2021-12-16:17:15:05:INFO:sockeye.data_io:log] 1137 sequences across 26 buckets
[2021-12-16:17:15:05:INFO:sockeye.data_io:log] 5 sequences did not fit into buckets and were discarded
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (16, 16): 812 samples in 2 batches of 536, ~4114.7 target tokens/batch, trg/src length ratio: 0.57 (+-0.21)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (24, 24): 167 samples in 1 batches of 376, ~4105.1 target tokens/batch, trg/src length ratio: 0.60 (+-0.39)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (32, 32): 9 samples in 1 batches of 256, ~4088.3 target tokens/batch, trg/src length ratio: 0.52 (+-0.23)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (40, 40): 6 samples in 1 batches of 136, ~4131.5 target tokens/batch, trg/src length ratio: 1.43 (+-0.88)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (48, 48): 2 samples in 1 batches of 96, ~4070.6 target tokens/batch, trg/src length ratio: 1.95 (+-0.69)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (56, 56): 10 samples in 1 batches of 80, ~4090.4 target tokens/batch, trg/src length ratio: 1.53 (+-0.62)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (64, 64): 14 samples in 1 batches of 72, ~4284.3 target tokens/batch, trg/src length ratio: 1.83 (+-0.38)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (72, 72): 14 samples in 1 batches of 64, ~4326.4 target tokens/batch, trg/src length ratio: 1.60 (+-0.78)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (80, 80): 8 samples in 1 batches of 56, ~4235.8 target tokens/batch, trg/src length ratio: 3.56 (+-1.87)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (88, 88): 10 samples in 1 batches of 48, ~4034.3 target tokens/batch, trg/src length ratio: 2.03 (+-0.18)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (96, 96): 14 samples in 1 batches of 48, ~4431.2 target tokens/batch, trg/src length ratio: 2.26 (+-0.45)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (104, 104): 15 samples in 1 batches of 40, ~4009.0 target tokens/batch, trg/src length ratio: 2.20 (+-0.42)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (112, 112): 10 samples in 1 batches of 40, ~4330.3 target tokens/batch, trg/src length ratio: 2.67 (+-1.62)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (120, 120): 7 samples in 1 batches of 32, ~3725.0 target tokens/batch, trg/src length ratio: 3.30 (+-2.74)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (128, 128): 10 samples in 1 batches of 32, ~3976.0 target tokens/batch, trg/src length ratio: 2.55 (+-1.20)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (136, 136): 6 samples in 1 batches of 32, ~4239.8 target tokens/batch, trg/src length ratio: 2.24 (+-0.45)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (144, 144): 4 samples in 1 batches of 32, ~4495.0 target tokens/batch, trg/src length ratio: 2.59 (+-0.49)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (152, 152): 2 samples in 1 batches of 24, ~3559.2 target tokens/batch, trg/src length ratio: 2.13 (+-0.00)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (160, 160): 7 samples in 1 batches of 24, ~3738.7 target tokens/batch, trg/src length ratio: 2.65 (+-0.52)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (168, 168): 3 samples in 1 batches of 24, ~3943.0 target tokens/batch, trg/src length ratio: 2.61 (+-0.21)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (176, 176): 4 samples in 1 batches of 24, ~4133.9 target tokens/batch, trg/src length ratio: 3.15 (+-1.78)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (184, 184): 2 samples in 1 batches of 24, ~4300.8 target tokens/batch, trg/src length ratio: 2.31 (+-0.07)
[2021-12-16:17:15:05:INFO:sockeye.data_io:describe_data_and_buckets] Bucket (200, 200): 1 samples in 1 batches of 24, ~4699.4 target tokens/batch, trg/src length ratio: 2.92 (+-0.00)
[2021-12-16:17:15:05:INFO:sockeye.data_io:load] Created bucketed parallel data set. Introduced padding: source=35.2% target=31.1%)
[2021-12-16:17:15:05:INFO:__main__:train] Maximum source length determined by prepared data. Using 201 instead of 96
[2021-12-16:17:15:05:INFO:__main__:train] Maximum target length determined by prepared data. Using 201 instead of 96
[2021-12-16:17:15:05:INFO:sockeye.vocab:vocab_to_json] Vocabulary saved to "/net/cephfs/home/zifjia/signwriting-translation/models/sockeye_spoken2symbol/vocab.src.0.json"
[2021-12-16:17:15:05:INFO:sockeye.vocab:vocab_to_json] Vocabulary saved to "/net/cephfs/home/zifjia/signwriting-translation/models/sockeye_spoken2symbol/vocab.trg.0.json"
[2021-12-16:17:15:05:INFO:__main__:train] Vocabulary sizes: source=[2000] target=[12224]
[2021-12-16:17:15:05:INFO:__main__:get_num_embed] Source embedding size was not set it will automatically be adjusted to match the Transformer source model size (512).
[2021-12-16:17:15:05:INFO:__main__:get_num_embed] Target embedding size was not set it will automatically be adjusted to match the Transformer target model size (512).
[2021-12-16:17:15:05:INFO:sockeye.model:__init__] ModelConfig(config_data=DataConfig(data_statistics=DataStatistics(num_sents=111529, num_discarded=417, num_tokens_source=2075941, num_tokens_target=2225438, num_unks_source=0, num_unks_target=0, max_observed_len_source=185, max_observed_len_target=201, size_vocab_source=2000, size_vocab_target=12224, length_ratio_mean=0.7952563989633317, length_ratio_std=0.6990334237388166, buckets=[(8, 8), (16, 16), (24, 24), (32, 32), (40, 40), (48, 48), (56, 56), (64, 64), (72, 72), (80, 80), (88, 88), (96, 96), (104, 104), (112, 112), (120, 120), (128, 128), (136, 136), (144, 144), (152, 152), (160, 160), (168, 168), (176, 176), (184, 184), (192, 192), (200, 200), (201, 201)], num_sents_per_bucket=[0, 81219, 14620, 1193, 457, 408, 628, 1030, 1224, 1199, 1150, 1259, 1170, 1106, 1014, 916, 731, 552, 498, 361, 263, 213, 145, 95, 68, 10], average_len_target_per_bucket=[None, 7.676615077752828, 10.917852257181917, 15.969823973176855, 30.378555798687103, 42.40196078431373, 51.130573248407686, 59.50485436893204, 67.60049019607851, 75.63886572143453, 84.04869565217392, 92.31691818903899, 100.22478632478625, 108.258589511754, 116.40631163708095, 124.24999999999997, 132.4924760601916, 140.4692028985508, 148.30120481927696, 155.7811634349031, 164.2927756653993, 172.24413145539899, 179.1999999999999, 187.85263157894744, 195.8088235294118, 201.0], length_ratio_stats_per_bucket=[(None, None), (0.5731306316243342, 0.20605685798846987), (0.6421342240936343, 0.39770008592915274), (0.859732548795569, 0.7448782250345781), (1.548934235200316, 0.8692084159265917), (1.8718311852655898, 0.8023738240479706), (1.7827641324506083, 0.7199393121842907), (1.8144343418607083, 0.6790160245445268), (1.849389302228943, 0.6483646482433103), (1.9460433022889274, 0.714701152942034), (2.082878803106982, 0.7668277390407361), (2.1917070789285207, 0.7718414511646764), (2.2440640194205312, 0.763463890478365), (2.29744984926137, 0.8628994817056892), (2.376561672214239, 0.9278811630432776), (2.4055202846639103, 1.0308439838665555), (2.47307220374083, 1.1927088662158885), (2.449640906406911, 0.9844225288697896), (2.506961480708306, 1.1401135689536712), (2.738755276705606, 1.6542230528380326), (2.633704509461338, 1.5948046208089743), (2.695802278434618, 1.3733845272690017), (3.283258200500435, 2.5112983223576277), (3.6306240624382267, 3.172481624967147), (3.417168104320764, 2.6170087795834664), (2.253037210632548, 0.5958326376020144)]), max_seq_len_source=201, max_seq_len_target=201, num_source_factors=1, num_target_factors=1), vocab_source_size=2000, vocab_target_size=12224, config_embed_source=EmbeddingConfig(vocab_size=2000, num_embed=512, dropout=0.5, num_factors=1, factor_configs=None, allow_sparse_grad=True), config_embed_target=EmbeddingConfig(vocab_size=12224, num_embed=512, dropout=0.5, num_factors=1, factor_configs=None, allow_sparse_grad=True), config_encoder=TransformerConfig(model_size=512, attention_heads=8, feed_forward_num_hidden=2048, act_type='relu', num_layers=6, dropout_attention=0.5, dropout_act=0.1, dropout_prepost=0.1, positional_embedding_type='fixed', preprocess_sequence='n', postprocess_sequence='dr', max_seq_len_source=201, max_seq_len_target=201, decoder_type='transformer', use_lhuc=False, depth_key_value=512, use_glu=False), config_decoder=TransformerConfig(model_size=512, attention_heads=8, feed_forward_num_hidden=2048, act_type='relu', num_layers=6, dropout_attention=0.5, dropout_act=0.1, dropout_prepost=0.1, positional_embedding_type='fixed', preprocess_sequence='n', postprocess_sequence='dr', max_seq_len_source=201, max_seq_len_target=201, decoder_type='transformer', use_lhuc=False, depth_key_value=512, use_glu=False), config_length_task=None, weight_tying_type='trg_softmax', lhuc=False, dtype='float32', intgemm_custom_lib='/home/cluster/zifjia/.local/lib/python3.8/site-packages/sockeye/libintgemm.so')
[2021-12-16:17:15:05:INFO:sockeye.lr_scheduler:__init__] Will reduce the learning rate by a factor of 0.70 whenever the validation score doesn't improve 5 times.
[2021-12-16:17:15:05:INFO:__main__:create_optimizer_config] Optimizer: adam | kvstore=device | params={'wd': 0.0, 'learning_rate': 0.0001, 'rescale_grad': 1.0, 'lr_scheduler': LearningRateSchedulerPlateauReduce(reduce_factor=0.70, reduce_num_not_improved=5, num_not_improved=0, base_lr=0.0001, lr=None, warmup=0, warmed_up=True)} | initializer=<mxnet.initializer.Xavier object at 0x7f48b5184c40>
[2021-12-16:17:15:05:INFO:__main__:create_optimizer_config] Gradient accumulation over 1 batch(es) by 1 worker(s). Effective batch size: 4096
[2021-12-16:17:15:11:INFO:sockeye.utils:log_parameters] # of parameters: 51604416 | trainable: 51398592 (99.60%) | fixed: 205824 (0.40%)
[2021-12-16:17:15:11:INFO:sockeye.utils:log_parameters] Trainable parameters: 
['decoder.final_process.layer_norm.beta [(512,), float32]',
 'decoder.final_process.layer_norm.gamma [(512,), float32]',
 'decoder.layers.0.autoregr_layer.ff_in.weight [(1536, 512), float32]',
 'decoder.layers.0.autoregr_layer.ff_out.weight [(512, 512), float32]',
 'decoder.layers.0.enc_attention.ff_kv.weight [(1024, 512), float32]',
 'decoder.layers.0.enc_attention.ff_out.weight [(512, 512), float32]',
 'decoder.layers.0.enc_attention.ff_q.weight [(512, 512), float32]',
 'decoder.layers.0.ff.ff1.bias [(2048,), float32]',
 'decoder.layers.0.ff.ff1.weight [(2048, 512), float32]',
 'decoder.layers.0.ff.ff2.bias [(512,), float32]',
 'decoder.layers.0.ff.ff2.weight [(512, 2048), float32]',
 'decoder.layers.0.pre_autoregr_layer.layer_norm.beta [(512,), float32]',
 'decoder.layers.0.pre_autoregr_layer.layer_norm.gamma [(512,), float32]',
 'decoder.layers.0.pre_enc_attention.layer_norm.beta [(512,), float32]',
 'decoder.layers.0.pre_enc_attention.layer_norm.gamma [(512,), float32]',
 'decoder.layers.0.pre_ff.layer_norm.beta [(512,), float32]',
 'decoder.layers.0.pre_ff.layer_norm.gamma [(512,), float32]',
 'decoder.layers.1.autoregr_layer.ff_in.weight [(1536, 512), float32]',
 'decoder.layers.1.autoregr_layer.ff_out.weight [(512, 512), float32]',
 'decoder.layers.1.enc_attention.ff_kv.weight [(1024, 512), float32]',
 'decoder.layers.1.enc_attention.ff_out.weight [(512, 512), float32]',
 'decoder.layers.1.enc_attention.ff_q.weight [(512, 512), float32]',
 'decoder.layers.1.ff.ff1.bias [(2048,), float32]',
 'decoder.layers.1.ff.ff1.weight [(2048, 512), float32]',
 'decoder.layers.1.ff.ff2.bias [(512,), float32]',
 'decoder.layers.1.ff.ff2.weight [(512, 2048), float32]',
 'decoder.layers.1.pre_autoregr_layer.layer_norm.beta [(512,), float32]',
 'decoder.layers.1.pre_autoregr_layer.layer_norm.gamma [(512,), float32]',
 'decoder.layers.1.pre_enc_attention.layer_norm.beta [(512,), float32]',
 'decoder.layers.1.pre_enc_attention.layer_norm.gamma [(512,), float32]',
 'decoder.layers.1.pre_ff.layer_norm.beta [(512,), float32]',
 'decoder.layers.1.pre_ff.layer_norm.gamma [(512,), float32]',
 'decoder.layers.2.autoregr_layer.ff_in.weight [(1536, 512), float32]',
 'decoder.layers.2.autoregr_layer.ff_out.weight [(512, 512), float32]',
 'decoder.layers.2.enc_attention.ff_kv.weight [(1024, 512), float32]',
 'decoder.layers.2.enc_attention.ff_out.weight [(512, 512), float32]',
 'decoder.layers.2.enc_attention.ff_q.weight [(512, 512), float32]',
 'decoder.layers.2.ff.ff1.bias [(2048,), float32]',
 'decoder.layers.2.ff.ff1.weight [(2048, 512), float32]',
 'decoder.layers.2.ff.ff2.bias [(512,), float32]',
 'decoder.layers.2.ff.ff2.weight [(512, 2048), float32]',
 'decoder.layers.2.pre_autoregr_layer.layer_norm.beta [(512,), float32]',
 'decoder.layers.2.pre_autoregr_layer.layer_norm.gamma [(512,), float32]',
 'decoder.layers.2.pre_enc_attention.layer_norm.beta [(512,), float32]',
 'decoder.layers.2.pre_enc_attention.layer_norm.gamma [(512,), float32]',
 'decoder.layers.2.pre_ff.layer_norm.beta [(512,), float32]',
 'decoder.layers.2.pre_ff.layer_norm.gamma [(512,), float32]',
 'decoder.layers.3.autoregr_layer.ff_in.weight [(1536, 512), float32]',
 'decoder.layers.3.autoregr_layer.ff_out.weight [(512, 512), float32]',
 'decoder.layers.3.enc_attention.ff_kv.weight [(1024, 512), float32]',
 'decoder.layers.3.enc_attention.ff_out.weight [(512, 512), float32]',
 'decoder.layers.3.enc_attention.ff_q.weight [(512, 512), float32]',
 'decoder.layers.3.ff.ff1.bias [(2048,), float32]',
 'decoder.layers.3.ff.ff1.weight [(2048, 512), float32]',
 'decoder.layers.3.ff.ff2.bias [(512,), float32]',
 'decoder.layers.3.ff.ff2.weight [(512, 2048), float32]',
 'decoder.layers.3.pre_autoregr_layer.layer_norm.beta [(512,), float32]',
 'decoder.layers.3.pre_autoregr_layer.layer_norm.gamma [(512,), float32]',
 'decoder.layers.3.pre_enc_attention.layer_norm.beta [(512,), float32]',
 'decoder.layers.3.pre_enc_attention.layer_norm.gamma [(512,), float32]',
 'decoder.layers.3.pre_ff.layer_norm.beta [(512,), float32]',
 'decoder.layers.3.pre_ff.layer_norm.gamma [(512,), float32]',
 'decoder.layers.4.autoregr_layer.ff_in.weight [(1536, 512), float32]',
 'decoder.layers.4.autoregr_layer.ff_out.weight [(512, 512), float32]',
 'decoder.layers.4.enc_attention.ff_kv.weight [(1024, 512), float32]',
 'decoder.layers.4.enc_attention.ff_out.weight [(512, 512), float32]',
 'decoder.layers.4.enc_attention.ff_q.weight [(512, 512), float32]',
 'decoder.layers.4.ff.ff1.bias [(2048,), float32]',
 'decoder.layers.4.ff.ff1.weight [(2048, 512), float32]',
 'decoder.layers.4.ff.ff2.bias [(512,), float32]',
 'decoder.layers.4.ff.ff2.weight [(512, 2048), float32]',
 'decoder.layers.4.pre_autoregr_layer.layer_norm.beta [(512,), float32]',
 'decoder.layers.4.pre_autoregr_layer.layer_norm.gamma [(512,), float32]',
 'decoder.layers.4.pre_enc_attention.layer_norm.beta [(512,), float32]',
 'decoder.layers.4.pre_enc_attention.layer_norm.gamma [(512,), float32]',
 'decoder.layers.4.pre_ff.layer_norm.beta [(512,), float32]',
 'decoder.layers.4.pre_ff.layer_norm.gamma [(512,), float32]',
 'decoder.layers.5.autoregr_layer.ff_in.weight [(1536, 512), float32]',
 'decoder.layers.5.autoregr_layer.ff_out.weight [(512, 512), float32]',
 'decoder.layers.5.enc_attention.ff_kv.weight [(1024, 512), float32]',
 'decoder.layers.5.enc_attention.ff_out.weight [(512, 512), float32]',
 'decoder.layers.5.enc_attention.ff_q.weight [(512, 512), float32]',
 'decoder.layers.5.ff.ff1.bias [(2048,), float32]',
 'decoder.layers.5.ff.ff1.weight [(2048, 512), float32]',
 'decoder.layers.5.ff.ff2.bias [(512,), float32]',
 'decoder.layers.5.ff.ff2.weight [(512, 2048), float32]',
 'decoder.layers.5.pre_autoregr_layer.layer_norm.beta [(512,), float32]',
 'decoder.layers.5.pre_autoregr_layer.layer_norm.gamma [(512,), float32]',
 'decoder.layers.5.pre_enc_attention.layer_norm.beta [(512,), float32]',
 'decoder.layers.5.pre_enc_attention.layer_norm.gamma [(512,), float32]',
 'decoder.layers.5.pre_ff.layer_norm.beta [(512,), float32]',
 'decoder.layers.5.pre_ff.layer_norm.gamma [(512,), float32]',
 'embedding_source.weight [(2000, 512), float32]',
 'embedding_target.weight [(12224, 512), float32]',
 'encoder.final_process.layer_norm.beta [(512,), float32]',
 'encoder.final_process.layer_norm.gamma [(512,), float32]',
 'encoder.layers.0.ff.ff1.bias [(2048,), float32]',
 'encoder.layers.0.ff.ff1.weight [(2048, 512), float32]',
 'encoder.layers.0.ff.ff2.bias [(512,), float32]',
 'encoder.layers.0.ff.ff2.weight [(512, 2048), float32]',
 'encoder.layers.0.pre_ff.layer_norm.beta [(512,), float32]',
 'encoder.layers.0.pre_ff.layer_norm.gamma [(512,), float32]',
 'encoder.layers.0.pre_self_attention.layer_norm.beta [(512,), float32]',
 'encoder.layers.0.pre_self_attention.layer_norm.gamma [(512,), float32]',
 'encoder.layers.0.self_attention.ff_in.weight [(1536, 512), float32]',
 'encoder.layers.0.self_attention.ff_out.weight [(512, 512), float32]',
 'encoder.layers.1.ff.ff1.bias [(2048,), float32]',
 'encoder.layers.1.ff.ff1.weight [(2048, 512), float32]',
 'encoder.layers.1.ff.ff2.bias [(512,), float32]',
 'encoder.layers.1.ff.ff2.weight [(512, 2048), float32]',
 'encoder.layers.1.pre_ff.layer_norm.beta [(512,), float32]',
 'encoder.layers.1.pre_ff.layer_norm.gamma [(512,), float32]',
 'encoder.layers.1.pre_self_attention.layer_norm.beta [(512,), float32]',
 'encoder.layers.1.pre_self_attention.layer_norm.gamma [(512,), float32]',
 'encoder.layers.1.self_attention.ff_in.weight [(1536, 512), float32]',
 'encoder.layers.1.self_attention.ff_out.weight [(512, 512), float32]',
 'encoder.layers.2.ff.ff1.bias [(2048,), float32]',
 'encoder.layers.2.ff.ff1.weight [(2048, 512), float32]',
 'encoder.layers.2.ff.ff2.bias [(512,), float32]',
 'encoder.layers.2.ff.ff2.weight [(512, 2048), float32]',
 'encoder.layers.2.pre_ff.layer_norm.beta [(512,), float32]',
 'encoder.layers.2.pre_ff.layer_norm.gamma [(512,), float32]',
 'encoder.layers.2.pre_self_attention.layer_norm.beta [(512,), float32]',
 'encoder.layers.2.pre_self_attention.layer_norm.gamma [(512,), float32]',
 'encoder.layers.2.self_attention.ff_in.weight [(1536, 512), float32]',
 'encoder.layers.2.self_attention.ff_out.weight [(512, 512), float32]',
 'encoder.layers.3.ff.ff1.bias [(2048,), float32]',
 'encoder.layers.3.ff.ff1.weight [(2048, 512), float32]',
 'encoder.layers.3.ff.ff2.bias [(512,), float32]',
 'encoder.layers.3.ff.ff2.weight [(512, 2048), float32]',
 'encoder.layers.3.pre_ff.layer_norm.beta [(512,), float32]',
 'encoder.layers.3.pre_ff.layer_norm.gamma [(512,), float32]',
 'encoder.layers.3.pre_self_attention.layer_norm.beta [(512,), float32]',
 'encoder.layers.3.pre_self_attention.layer_norm.gamma [(512,), float32]',
 'encoder.layers.3.self_attention.ff_in.weight [(1536, 512), float32]',
 'encoder.layers.3.self_attention.ff_out.weight [(512, 512), float32]',
 'encoder.layers.4.ff.ff1.bias [(2048,), float32]',
 'encoder.layers.4.ff.ff1.weight [(2048, 512), float32]',
 'encoder.layers.4.ff.ff2.bias [(512,), float32]',
 'encoder.layers.4.ff.ff2.weight [(512, 2048), float32]',
 'encoder.layers.4.pre_ff.layer_norm.beta [(512,), float32]',
 'encoder.layers.4.pre_ff.layer_norm.gamma [(512,), float32]',
 'encoder.layers.4.pre_self_attention.layer_norm.beta [(512,), float32]',
 'encoder.layers.4.pre_self_attention.layer_norm.gamma [(512,), float32]',
 'encoder.layers.4.self_attention.ff_in.weight [(1536, 512), float32]',
 'encoder.layers.4.self_attention.ff_out.weight [(512, 512), float32]',
 'encoder.layers.5.ff.ff1.bias [(2048,), float32]',
 'encoder.layers.5.ff.ff1.weight [(2048, 512), float32]',
 'encoder.layers.5.ff.ff2.bias [(512,), float32]',
 'encoder.layers.5.ff.ff2.weight [(512, 2048), float32]',
 'encoder.layers.5.pre_ff.layer_norm.beta [(512,), float32]',
 'encoder.layers.5.pre_ff.layer_norm.gamma [(512,), float32]',
 'encoder.layers.5.pre_self_attention.layer_norm.beta [(512,), float32]',
 'encoder.layers.5.pre_self_attention.layer_norm.gamma [(512,), float32]',
 'encoder.layers.5.self_attention.ff_in.weight [(1536, 512), float32]',
 'encoder.layers.5.self_attention.ff_out.weight [(512, 512), float32]',
 'output_layer.bias [(12224,), float32]',
 'output_layer.weight [(12224, 512), float32]']
[2021-12-16:17:15:11:INFO:sockeye.utils:log_parameters] Shared parameters: 
['embedding_target.weight = output_layer.weight']
[2021-12-16:17:15:11:INFO:sockeye.utils:log_parameters] Fixed parameters:
['decoder.pos_embedding.weight [(201, 512), float32]',
 'encoder.pos_embedding.weight [(201, 512), float32]']
[2021-12-16:17:15:11:INFO:sockeye.loss:__init__] Loss: cross-entropy | weight=1.00 | metric: perplexity (ppl) | output_name: 'logits' | label_name: 'target_label'
[2021-12-16:17:15:11:INFO:sockeye.training:__init__] mxboard not found. Consider 'pip install mxboard' to log events to Tensorboard.
[2021-12-16:17:15:11:INFO:sockeye.inference:__init__] Translator (1 model(s) beam_size=5 algorithm=BeamSearch, beam_search_stop=all max_input_length=200 nbest_size=1 ensemble_mode=None max_batch_size=16 avoiding=0 dtype=float32 softmax_temperature=None)
[2021-12-16:17:15:11:INFO:sockeye.checkpoint_decoder:__init__] Created CheckpointDecoder(max_input_len=-1, beam_size=5, num_sentences=1142)
[2021-12-16:17:15:11:INFO:sockeye.training:fit] Early stopping by optimizing 'perplexity'
[2021-12-16:17:15:11:INFO:sockeye.model:save_config] Saved model config to "models/sockeye_spoken2symbol/config"
[2021-12-16:17:15:11:INFO:sockeye.training:fit] Training started.
[2021-12-16:17:15:29:INFO:sockeye.training:__call__] E=0 B=50	s/sec=731.03 tok/sec=22352.02 u/sec=3.84	ppl=2655.313254 
[2021-12-16:17:15:39:INFO:sockeye.training:__call__] E=0 B=100	s/sec=888.37 tok/sec=27091.92 u/sec=4.78	ppl=1542.226231 
[2021-12-16:17:15:49:INFO:sockeye.training:__call__] E=0 B=150	s/sec=908.92 tok/sec=29348.97 u/sec=5.28	ppl=1208.422289 
[2021-12-16:17:15:59:INFO:sockeye.training:__call__] E=0 B=200	s/sec=976.86 tok/sec=29209.70 u/sec=5.00	ppl=1030.452486 
[2021-12-16:17:16:09:INFO:sockeye.training:__call__] E=0 B=250	s/sec=977.24 tok/sec=29302.45 u/sec=5.08	ppl=907.873607 
[2021-12-16:17:16:19:INFO:sockeye.training:__call__] E=0 B=300	s/sec=1130.23 tok/sec=29880.07 u/sec=4.68	ppl=834.421504 
[2021-12-16:17:16:29:INFO:sockeye.training:__call__] E=0 B=350	s/sec=912.19 tok/sec=29025.94 u/sec=5.34	ppl=754.047615 
[2021-12-16:17:16:38:INFO:sockeye.training:__call__] E=0 B=400	s/sec=835.87 tok/sec=28854.10 u/sec=5.43	ppl=685.006052 
[2021-12-16:17:16:48:INFO:sockeye.training:__call__] E=0 B=450	s/sec=1205.22 tok/sec=29838.36 u/sec=4.76	ppl=639.780316 
[2021-12-16:17:16:59:INFO:sockeye.training:__call__] E=0 B=500	s/sec=1225.92 tok/sec=29670.44 u/sec=4.73	ppl=601.086129 
[2021-12-16:17:17:09:INFO:sockeye.training:__call__] E=0 B=550	s/sec=1086.03 tok/sec=29165.77 u/sec=4.90	ppl=566.851323 
[2021-12-16:17:17:19:INFO:sockeye.training:__call__] E=1 B=600	s/sec=1032.23 tok/sec=29378.76 u/sec=4.93	ppl=534.874800 
[2021-12-16:17:17:29:INFO:sockeye.training:__call__] E=1 B=650	s/sec=975.50 tok/sec=29184.02 u/sec=4.96	ppl=506.804334 
[2021-12-16:17:17:40:INFO:sockeye.training:__call__] E=1 B=700	s/sec=1099.32 tok/sec=29777.17 u/sec=4.86	ppl=482.979097 
[2021-12-16:17:17:50:INFO:sockeye.training:__call__] E=1 B=750	s/sec=1107.25 tok/sec=29423.72 u/sec=4.83	ppl=462.691660 
[2021-12-16:17:18:00:INFO:sockeye.training:__call__] E=1 B=800	s/sec=1043.74 tok/sec=28910.00 u/sec=4.84	ppl=443.495024 
[2021-12-16:17:18:10:INFO:sockeye.training:__call__] E=1 B=850	s/sec=855.97 tok/sec=28742.87 u/sec=5.33	ppl=422.942359 
[2021-12-16:17:18:20:INFO:sockeye.training:__call__] E=1 B=900	s/sec=970.33 tok/sec=29389.79 u/sec=5.09	ppl=406.727967 
[2021-12-16:17:18:30:INFO:sockeye.training:__call__] E=1 B=950	s/sec=1021.97 tok/sec=29042.62 u/sec=4.95	ppl=392.445613 
[2021-12-16:17:18:39:INFO:sockeye.training:__call__] E=1 B=1000	s/sec=992.56 tok/sec=29026.51 u/sec=5.19	ppl=379.289157 
[2021-12-16:17:18:49:INFO:sockeye.training:__call__] E=1 B=1050	s/sec=1038.29 tok/sec=29180.68 u/sec=4.98	ppl=367.432447 
[2021-12-16:17:18:59:INFO:sockeye.training:__call__] E=1 B=1100	s/sec=1016.86 tok/sec=29111.65 u/sec=5.07	ppl=355.848989 
[2021-12-16:17:19:09:INFO:sockeye.training:__call__] E=2 B=1150	s/sec=1045.07 tok/sec=29092.08 u/sec=5.01	ppl=345.708055 
[2021-12-16:17:19:19:INFO:sockeye.training:__call__] E=2 B=1200	s/sec=835.08 tok/sec=28638.97 u/sec=5.35	ppl=334.652540 
[2021-12-16:17:19:29:INFO:sockeye.training:__call__] E=2 B=1250	s/sec=1147.58 tok/sec=29624.58 u/sec=4.68	ppl=328.177644 
[2021-12-16:17:19:39:INFO:sockeye.training:__call__] E=2 B=1300	s/sec=997.31 tok/sec=29056.37 u/sec=4.94	ppl=320.704590 
[2021-12-16:17:19:49:INFO:sockeye.training:__call__] E=2 B=1350	s/sec=844.82 tok/sec=28608.63 u/sec=5.37	ppl=311.373828 
[2021-12-16:17:19:59:INFO:sockeye.training:__call__] E=2 B=1400	s/sec=991.23 tok/sec=29490.84 u/sec=5.06	ppl=304.360557 
[2021-12-16:17:20:09:INFO:sockeye.training:__call__] E=2 B=1450	s/sec=1067.88 tok/sec=29445.54 u/sec=4.87	ppl=298.505700 
[2021-12-16:17:20:19:INFO:sockeye.training:__call__] E=2 B=1500	s/sec=968.66 tok/sec=28951.94 u/sec=5.04	ppl=291.908287 
[2021-12-16:17:20:29:INFO:sockeye.training:__call__] E=2 B=1550	s/sec=942.15 tok/sec=28764.89 u/sec=5.08	ppl=286.248737 
[2021-12-16:17:20:39:INFO:sockeye.training:__call__] E=2 B=1600	s/sec=1131.17 tok/sec=29424.86 u/sec=5.00	ppl=281.315887 
[2021-12-16:17:20:49:INFO:sockeye.training:__call__] E=2 B=1650	s/sec=1138.28 tok/sec=29319.24 u/sec=4.64	ppl=277.278996 
[2021-12-16:17:21:00:INFO:sockeye.training:__call__] E=3 B=1700	s/sec=1062.01 tok/sec=29389.86 u/sec=4.88	ppl=272.895249 
[2021-12-16:17:21:10:INFO:sockeye.training:__call__] E=3 B=1750	s/sec=1260.96 tok/sec=29674.25 u/sec=4.69	ppl=269.143058 
[2021-12-16:17:21:20:INFO:sockeye.training:__call__] E=3 B=1800	s/sec=914.82 tok/sec=28887.89 u/sec=5.20	ppl=264.117239 
[2021-12-16:17:21:31:INFO:sockeye.training:__call__] E=3 B=1850	s/sec=1208.43 tok/sec=29679.30 u/sec=4.64	ppl=261.068800 
[2021-12-16:17:21:41:INFO:sockeye.training:__call__] E=3 B=1900	s/sec=1092.69 tok/sec=29608.05 u/sec=4.85	ppl=257.636101 
[2021-12-16:17:21:51:INFO:sockeye.training:__call__] E=3 B=1950	s/sec=923.09 tok/sec=28703.21 u/sec=5.06	ppl=253.578841 
[2021-12-16:17:22:01:INFO:sockeye.training:__call__] E=3 B=2000	s/sec=929.03 tok/sec=29072.01 u/sec=5.02	ppl=249.709354 
[2021-12-16:17:22:11:INFO:sockeye.training:__call__] E=3 B=2050	s/sec=1031.15 tok/sec=29402.12 u/sec=4.99	ppl=246.172756 
[2021-12-16:17:22:21:INFO:sockeye.training:__call__] E=3 B=2100	s/sec=941.43 tok/sec=28909.43 u/sec=5.05	ppl=242.830897 
[2021-12-16:17:22:30:INFO:sockeye.training:__call__] E=3 B=2150	s/sec=777.41 tok/sec=28685.95 u/sec=5.49	ppl=238.385960 
[2021-12-16:17:22:40:INFO:sockeye.training:__call__] E=3 B=2200	s/sec=1042.39 tok/sec=28884.25 u/sec=4.93	ppl=235.418433 
[2021-12-16:17:22:50:INFO:sockeye.training:__call__] E=4 B=2250	s/sec=962.58 tok/sec=29138.24 u/sec=5.16	ppl=232.006040 
[2021-12-16:17:23:00:INFO:sockeye.training:__call__] E=4 B=2300	s/sec=990.36 tok/sec=29156.54 u/sec=4.87	ppl=229.467116 
[2021-12-16:17:23:10:INFO:sockeye.training:__call__] E=4 B=2350	s/sec=1078.17 tok/sec=29458.62 u/sec=4.84	ppl=227.049337 
[2021-12-16:17:23:21:INFO:sockeye.training:__call__] E=4 B=2400	s/sec=1099.49 tok/sec=29336.21 u/sec=4.81	ppl=224.623951 
[2021-12-16:17:23:31:INFO:sockeye.training:__call__] E=4 B=2450	s/sec=1066.27 tok/sec=29305.00 u/sec=4.80	ppl=222.492601 
[2021-12-16:17:23:41:INFO:sockeye.training:__call__] E=4 B=2500	s/sec=919.77 tok/sec=28716.12 u/sec=5.23	ppl=219.388110 
[2021-12-16:17:23:51:INFO:sockeye.training:__call__] E=4 B=2550	s/sec=1121.33 tok/sec=29466.21 u/sec=4.84	ppl=217.303978 
[2021-12-16:17:24:01:INFO:sockeye.training:__call__] E=4 B=2600	s/sec=1005.30 tok/sec=29250.97 u/sec=5.11	ppl=214.816573 
[2021-12-16:17:24:11:INFO:sockeye.training:__call__] E=4 B=2650	s/sec=929.24 tok/sec=28778.26 u/sec=5.05	ppl=212.386432 
[2021-12-16:17:24:21:INFO:sockeye.training:__call__] E=4 B=2700	s/sec=1041.56 tok/sec=29002.28 u/sec=5.05	ppl=210.139842 
[2021-12-16:17:24:30:INFO:sockeye.training:__call__] E=4 B=2750	s/sec=891.36 tok/sec=28837.67 u/sec=5.22	ppl=207.636962 
[2021-12-16:17:24:40:INFO:sockeye.training:__call__] E=5 B=2800	s/sec=765.83 tok/sec=28599.93 u/sec=5.26	ppl=205.028062 
[2021-12-16:17:24:50:INFO:sockeye.training:__call__] E=5 B=2850	s/sec=1123.21 tok/sec=29594.37 u/sec=4.72	ppl=203.520956 
[2021-12-16:17:25:01:INFO:sockeye.training:__call__] E=5 B=2900	s/sec=1033.40 tok/sec=29006.96 u/sec=4.88	ppl=201.645848 
[2021-12-16:17:25:11:INFO:sockeye.training:__call__] E=5 B=2950	s/sec=1039.78 tok/sec=29255.94 u/sec=4.93	ppl=199.897404 
[2021-12-16:17:25:21:INFO:sockeye.training:__call__] E=5 B=3000	s/sec=1093.19 tok/sec=29208.68 u/sec=4.94	ppl=198.077869 
[2021-12-16:17:25:31:INFO:sockeye.training:__call__] E=5 B=3050	s/sec=1090.91 tok/sec=29367.06 u/sec=4.98	ppl=196.336602 
[2021-12-16:17:25:41:INFO:sockeye.training:__call__] E=5 B=3100	s/sec=1145.09 tok/sec=29502.00 u/sec=4.83	ppl=194.794300 
[2021-12-16:17:25:51:INFO:sockeye.training:__call__] E=5 B=3150	s/sec=971.50 tok/sec=28914.00 u/sec=5.19	ppl=192.769663 
[2021-12-16:17:26:00:INFO:sockeye.training:__call__] E=5 B=3200	s/sec=849.20 tok/sec=28701.16 u/sec=5.25	ppl=190.816790 
[2021-12-16:17:26:11:INFO:sockeye.training:__call__] E=5 B=3250	s/sec=1114.89 tok/sec=29661.20 u/sec=4.78	ppl=189.621081 
[2021-12-16:17:26:20:INFO:sockeye.training:__call__] E=5 B=3300	s/sec=808.61 tok/sec=28557.95 u/sec=5.29	ppl=187.791040 
[2021-12-16:17:26:30:INFO:sockeye.training:__call__] E=6 B=3350	s/sec=906.59 tok/sec=28858.80 u/sec=5.17	ppl=185.996556 
[2021-12-16:17:26:40:INFO:sockeye.training:__call__] E=6 B=3400	s/sec=937.96 tok/sec=29145.05 u/sec=5.03	ppl=184.477706 
[2021-12-16:17:26:50:INFO:sockeye.training:__call__] E=6 B=3450	s/sec=1012.32 tok/sec=28983.73 u/sec=5.07	ppl=182.940269 
[2021-12-16:17:27:00:INFO:sockeye.training:__call__] E=6 B=3500	s/sec=1243.15 tok/sec=29871.43 u/sec=4.66	ppl=181.971017 
[2021-12-16:17:27:11:INFO:sockeye.training:__call__] E=6 B=3550	s/sec=1130.96 tok/sec=29233.90 u/sec=4.78	ppl=180.763625 
[2021-12-16:17:27:21:INFO:sockeye.training:__call__] E=6 B=3600	s/sec=1178.10 tok/sec=29778.00 u/sec=4.78	ppl=179.768089 
[2021-12-16:17:27:31:INFO:sockeye.training:__call__] E=6 B=3650	s/sec=939.75 tok/sec=29014.19 u/sec=5.17	ppl=178.276666 
[2021-12-16:17:27:41:INFO:sockeye.training:__call__] E=6 B=3700	s/sec=881.04 tok/sec=28828.94 u/sec=4.93	ppl=177.026011 
[2021-12-16:17:27:51:INFO:sockeye.training:__call__] E=6 B=3750	s/sec=916.19 tok/sec=29068.33 u/sec=5.27	ppl=175.524869 
[2021-12-16:17:28:00:INFO:sockeye.training:__call__] E=6 B=3800	s/sec=942.37 tok/sec=28669.31 u/sec=5.21	ppl=174.150158 
[2021-12-16:17:28:10:INFO:sockeye.training:__call__] E=6 B=3850	s/sec=1088.49 tok/sec=29504.51 u/sec=4.94	ppl=173.016782 
[2021-12-16:17:28:21:INFO:sockeye.training:__call__] E=7 B=3900	s/sec=987.14 tok/sec=28987.57 u/sec=4.92	ppl=171.832209 
[2021-12-16:17:28:31:INFO:sockeye.training:__call__] E=7 B=3950	s/sec=1069.33 tok/sec=29631.73 u/sec=4.94	ppl=170.786770 
[2021-12-16:17:28:40:INFO:sockeye.training:__call__] E=7 B=4000	s/sec=893.02 tok/sec=29013.48 u/sec=5.25	ppl=169.500557 
[2021-12-16:17:28:41:INFO:root:save_parameters] Saved params to "models/sockeye_spoken2symbol/params.00001"
[2021-12-16:17:28:41:INFO:sockeye.training:_create_checkpoint] Checkpoint [1]	Updates=4000 Epoch=7 Samples=812480 Time-cost=809.025 Updates/sec=4.944
[2021-12-16:17:28:41:INFO:sockeye.training:_create_checkpoint] Checkpoint [1]	Train-ppl=169.500557
[2021-12-16:17:29:19:INFO:sockeye.training:_evaluate] Checkpoint [1]	Validation-ppl=89.514416	Validation-bleu=0.085492	Validation-chrf=0.324771	Validation-rouge1=0.270988	Validation-rouge2=0.045623	Validation-rougel=0.202152	Validation-length-ratio-mse=1.442575	Validation-avg-sec-per-sent=0.030465	Validation-decode-walltime=34.791377
[2021-12-16:17:29:19:INFO:sockeye.training:_determine_improvement] Validation-perplexity improved to 89.514416 (delta=inf).
[2021-12-16:17:29:19:INFO:sockeye.training:_update_best_params] 'models/sockeye_spoken2symbol/params.best' now points to 'params.00001'
[2021-12-16:17:29:20:INFO:sockeye.training:_save_trainer_states] Saved optimizer states to "models/sockeye_spoken2symbol/mx_optimizer_best.pkl"
[2021-12-16:17:29:20:INFO:sockeye.training:_save_lr_scheduler] Saved 'LearningRateSchedulerPlateauReduce(reduce_factor=0.70, reduce_num_not_improved=5, num_not_improved=0, base_lr=0.0001, lr=0.0001, warmup=0, warmed_up=True)' to 'models/sockeye_spoken2symbol/lr_scheduler_best.pkl'
[2021-12-16:17:29:21:INFO:sockeye.utils:log_gpu_memory_usage] GPU 0: 17683/34089 MB (51.87%)
[2021-12-16:17:29:22:INFO:sockeye.training:_save_trainer_states] Saved optimizer states to "models/sockeye_spoken2symbol/tmp.training_state/mx_optimizer_last.pkl"
[2021-12-16:17:29:29:INFO:sockeye.training:_save_lr_scheduler] Saved 'LearningRateSchedulerPlateauReduce(reduce_factor=0.70, reduce_num_not_improved=5, num_not_improved=0, base_lr=0.0001, lr=0.0001, warmup=0, warmed_up=True)' to 'models/sockeye_spoken2symbol/tmp.training_state/lr_scheduler_last.pkl'
[2021-12-16:17:29:39:INFO:sockeye.training:__call__] E=7 B=4050	s/sec=186.78 tok/sec=5077.90 u/sec=0.85	ppl=107.230244 
[2021-12-16:17:29:48:INFO:sockeye.training:__call__] E=7 B=4100	s/sec=905.80 tok/sec=29005.98 u/sec=5.27	ppl=98.040444 
[2021-12-16:17:29:59:INFO:sockeye.training:__call__] E=7 B=4150	s/sec=1029.87 tok/sec=29408.01 u/sec=4.88	ppl=101.308353 
[2021-12-16:17:30:09:INFO:sockeye.training:__call__] E=7 B=4200	s/sec=1061.80 tok/sec=29389.05 u/sec=4.94	ppl=101.451828 
[2021-12-16:17:30:18:INFO:sockeye.training:__call__] E=7 B=4250	s/sec=996.51 tok/sec=29434.41 u/sec=5.13	ppl=98.997502 
[2021-12-16:17:30:28:INFO:sockeye.training:__call__] E=7 B=4300	s/sec=1003.96 tok/sec=29166.17 u/sec=5.11	ppl=98.226296 
[2021-12-16:17:30:39:INFO:sockeye.training:__call__] E=7 B=4350	s/sec=1022.46 tok/sec=28535.22 u/sec=4.80	ppl=98.066313 
[2021-12-16:17:30:49:INFO:sockeye.training:__call__] E=7 B=4400	s/sec=1143.42 tok/sec=29380.80 u/sec=4.79	ppl=98.747971 
[2021-12-16:17:30:59:INFO:sockeye.training:__call__] E=8 B=4450	s/sec=1134.80 tok/sec=29689.95 u/sec=4.82	ppl=99.618524 
[2021-12-16:17:31:10:INFO:sockeye.training:__call__] E=8 B=4500	s/sec=1076.80 tok/sec=29065.56 u/sec=4.96	ppl=98.802417 
[2021-12-16:17:31:20:INFO:sockeye.training:__call__] E=8 B=4550	s/sec=1075.18 tok/sec=29402.41 u/sec=4.88	ppl=98.706156 
[2021-12-16:17:31:30:INFO:sockeye.training:__call__] E=8 B=4600	s/sec=1094.85 tok/sec=29594.84 u/sec=4.92	ppl=98.818580 
[2021-12-16:17:31:39:INFO:sockeye.training:__call__] E=8 B=4650	s/sec=879.80 tok/sec=28511.41 u/sec=5.27	ppl=97.235961 
[2021-12-16:17:31:50:INFO:sockeye.training:__call__] E=8 B=4700	s/sec=980.50 tok/sec=29143.94 u/sec=4.92	ppl=97.017530 
[2021-12-16:17:31:59:INFO:sockeye.training:__call__] E=8 B=4750	s/sec=960.29 tok/sec=29327.29 u/sec=5.09	ppl=96.536917 
[2021-12-16:17:32:10:INFO:sockeye.training:__call__] E=8 B=4800	s/sec=1038.47 tok/sec=29195.08 u/sec=4.84	ppl=96.757918 
[2021-12-16:17:32:19:INFO:sockeye.training:__call__] E=8 B=4850	s/sec=944.34 tok/sec=29228.74 u/sec=5.19	ppl=96.182349 
[2021-12-16:17:32:29:INFO:sockeye.training:__call__] E=8 B=4900	s/sec=843.26 tok/sec=28598.38 u/sec=5.25	ppl=95.388306 
[2021-12-16:17:32:39:INFO:sockeye.training:__call__] E=8 B=4950	s/sec=991.03 tok/sec=29306.96 u/sec=5.14	ppl=94.972211 
[2021-12-16:17:32:49:INFO:sockeye.training:__call__] E=9 B=5000	s/sec=1178.06 tok/sec=29618.10 u/sec=4.75	ppl=95.336763 
[2021-12-16:17:32:59:INFO:sockeye.training:__call__] E=9 B=5050	s/sec=1069.24 tok/sec=29034.42 u/sec=4.89	ppl=95.079422 
[2021-12-16:17:33:09:INFO:sockeye.training:__call__] E=9 B=5100	s/sec=1053.96 tok/sec=29321.77 u/sec=5.01	ppl=94.884406 
[2021-12-16:17:33:18:INFO:sockeye.training:__call__] E=9 B=5150	s/sec=738.04 tok/sec=28378.20 u/sec=5.62	ppl=93.681969 
[2021-12-16:17:33:29:INFO:sockeye.training:__call__] E=9 B=5200	s/sec=1099.43 tok/sec=29377.63 u/sec=4.82	ppl=93.754345 
[2021-12-16:17:33:39:INFO:sockeye.training:__call__] E=9 B=5250	s/sec=967.67 tok/sec=29164.63 u/sec=5.06	ppl=93.411730 
[2021-12-16:17:33:48:INFO:sockeye.training:__call__] E=9 B=5300	s/sec=868.38 tok/sec=28782.64 u/sec=5.28	ppl=92.661305 
[2021-12-16:17:33:59:INFO:sockeye.training:__call__] E=9 B=5350	s/sec=1211.32 tok/sec=29697.34 u/sec=4.61	ppl=93.195294 
[2021-12-16:17:34:09:INFO:sockeye.training:__call__] E=9 B=5400	s/sec=997.40 tok/sec=29112.36 u/sec=5.01	ppl=92.852549 
[2021-12-16:17:34:19:INFO:sockeye.training:__call__] E=9 B=5450	s/sec=977.75 tok/sec=29068.77 u/sec=5.03	ppl=92.625851 
[2021-12-16:17:34:29:INFO:sockeye.training:__call__] E=9 B=5500	s/sec=1064.55 tok/sec=29376.58 u/sec=4.88	ppl=92.595705 
[2021-12-16:17:34:39:INFO:sockeye.training:__call__] E=10 B=5550	s/sec=861.81 tok/sec=29054.71 u/sec=5.17	ppl=92.193185 
[2021-12-16:17:34:49:INFO:sockeye.training:__call__] E=10 B=5600	s/sec=1081.49 tok/sec=29346.30 u/sec=4.91	ppl=92.028960 
[2021-12-16:17:34:58:INFO:sockeye.training:__call__] E=10 B=5650	s/sec=778.40 tok/sec=28695.23 u/sec=5.45	ppl=91.327556 
[2021-12-16:17:35:08:INFO:sockeye.training:__call__] E=10 B=5700	s/sec=1046.44 tok/sec=29141.78 u/sec=4.95	ppl=91.166301 
[2021-12-16:17:35:18:INFO:sockeye.training:__call__] E=10 B=5750	s/sec=922.97 tok/sec=29095.99 u/sec=5.12	ppl=90.862689 
[2021-12-16:17:35:28:INFO:sockeye.training:__call__] E=10 B=5800	s/sec=967.53 tok/sec=29193.72 u/sec=4.94	ppl=90.630973 
[2021-12-16:17:35:38:INFO:sockeye.training:__call__] E=10 B=5850	s/sec=970.19 tok/sec=29200.53 u/sec=5.02	ppl=90.455292 
[2021-12-16:17:35:48:INFO:sockeye.training:__call__] E=10 B=5900	s/sec=1129.35 tok/sec=29518.69 u/sec=4.91	ppl=90.322128 
[2021-12-16:17:35:59:INFO:sockeye.training:__call__] E=10 B=5950	s/sec=1147.87 tok/sec=29148.83 u/sec=4.79	ppl=90.279584 
[2021-12-16:17:36:09:INFO:sockeye.training:__call__] E=10 B=6000	s/sec=1019.38 tok/sec=29484.70 u/sec=5.04	ppl=90.121137 
[2021-12-16:17:36:19:INFO:sockeye.training:__call__] E=10 B=6050	s/sec=1085.93 tok/sec=29051.03 u/sec=4.83	ppl=90.136908 
[2021-12-16:17:36:29:INFO:sockeye.training:__call__] E=11 B=6100	s/sec=1176.61 tok/sec=29597.27 u/sec=4.74	ppl=90.161426 
[2021-12-16:17:36:40:INFO:sockeye.training:__call__] E=11 B=6150	s/sec=1139.17 tok/sec=29408.70 u/sec=4.93	ppl=89.990847 
[2021-12-16:17:36:50:INFO:sockeye.training:__call__] E=11 B=6200	s/sec=1104.09 tok/sec=29333.91 u/sec=4.89	ppl=89.898269 
[2021-12-16:17:37:00:INFO:sockeye.training:__call__] E=11 B=6250	s/sec=966.66 tok/sec=29276.05 u/sec=5.14	ppl=89.603163 
[2021-12-16:17:37:10:INFO:sockeye.training:__call__] E=11 B=6300	s/sec=982.73 tok/sec=28988.92 u/sec=5.00	ppl=89.374295 
[2021-12-16:17:37:19:INFO:sockeye.training:__call__] E=11 B=6350	s/sec=896.17 tok/sec=29124.21 u/sec=5.21	ppl=89.057162 
[2021-12-16:17:37:29:INFO:sockeye.training:__call__] E=11 B=6400	s/sec=1009.24 tok/sec=28840.86 u/sec=5.03	ppl=88.791499 
[2021-12-16:17:37:39:INFO:sockeye.training:__call__] E=11 B=6450	s/sec=956.66 tok/sec=29126.56 u/sec=5.05	ppl=88.602296 
[2021-12-16:17:37:49:INFO:sockeye.training:__call__] E=11 B=6500	s/sec=898.62 tok/sec=29064.85 u/sec=5.06	ppl=88.266633 
[2021-12-16:17:37:59:INFO:sockeye.training:__call__] E=11 B=6550	s/sec=1114.03 tok/sec=29647.34 u/sec=4.87	ppl=88.123453 
[2021-12-16:17:38:09:INFO:sockeye.training:__call__] E=11 B=6600	s/sec=912.24 tok/sec=28872.12 u/sec=5.10	ppl=87.884477 
[2021-12-16:17:38:19:INFO:sockeye.training:__call__] E=12 B=6650	s/sec=1080.61 tok/sec=29443.37 u/sec=4.97	ppl=87.759741 
[2021-12-16:17:38:29:INFO:sockeye.training:__call__] E=12 B=6700	s/sec=969.18 tok/sec=28870.20 u/sec=4.97	ppl=87.543226 
[2021-12-16:17:38:39:INFO:sockeye.training:__call__] E=12 B=6750	s/sec=990.21 tok/sec=29048.30 u/sec=5.14	ppl=87.251970 
[2021-12-16:17:38:49:INFO:sockeye.training:__call__] E=12 B=6800	s/sec=971.37 tok/sec=29130.09 u/sec=4.97	ppl=87.004126 
[2021-12-16:17:38:59:INFO:sockeye.training:__call__] E=12 B=6850	s/sec=1217.40 tok/sec=29844.76 u/sec=4.80	ppl=86.972367 
[2021-12-16:17:39:09:INFO:sockeye.training:__call__] E=12 B=6900	s/sec=1016.68 tok/sec=28872.85 u/sec=5.07	ppl=86.716372 
[2021-12-16:17:39:19:INFO:sockeye.training:__call__] E=12 B=6950	s/sec=985.11 tok/sec=29024.36 u/sec=4.99	ppl=86.516431 
[2021-12-16:17:39:29:INFO:sockeye.training:__call__] E=12 B=7000	s/sec=1017.69 tok/sec=29315.77 u/sec=4.95	ppl=86.362289 
[2021-12-16:17:39:39:INFO:sockeye.training:__call__] E=12 B=7050	s/sec=989.53 tok/sec=29056.76 u/sec=5.12	ppl=86.115801 
[2021-12-16:17:39:49:INFO:sockeye.training:__call__] E=12 B=7100	s/sec=867.15 tok/sec=29240.67 u/sec=5.16	ppl=85.868660 
[2021-12-16:17:39:59:INFO:sockeye.training:__call__] E=12 B=7150	s/sec=1059.15 tok/sec=29252.09 u/sec=4.78	ppl=85.843968 
[2021-12-16:17:40:09:INFO:sockeye.training:__call__] E=13 B=7200	s/sec=1061.24 tok/sec=29255.66 u/sec=4.91	ppl=85.680994 
[2021-12-16:17:40:20:INFO:sockeye.training:__call__] E=13 B=7250	s/sec=1297.60 tok/sec=30056.56 u/sec=4.66	ppl=85.719821 
[2021-12-16:17:40:30:INFO:sockeye.training:__call__] E=13 B=7300	s/sec=910.70 tok/sec=28948.99 u/sec=5.03	ppl=85.458945 
[2021-12-16:17:40:40:INFO:sockeye.training:__call__] E=13 B=7350	s/sec=889.92 tok/sec=28845.99 u/sec=5.24	ppl=85.118885 
[2021-12-16:17:40:50:INFO:sockeye.training:__call__] E=13 B=7400	s/sec=1231.70 tok/sec=29741.31 u/sec=4.59	ppl=85.173997 
[2021-12-16:17:41:00:INFO:sockeye.training:__call__] E=13 B=7450	s/sec=954.70 tok/sec=29073.27 u/sec=5.04	ppl=84.948565 
[2021-12-16:17:41:10:INFO:sockeye.training:__call__] E=13 B=7500	s/sec=894.32 tok/sec=29066.60 u/sec=5.31	ppl=84.603909 
[2021-12-16:17:41:20:INFO:sockeye.training:__call__] E=13 B=7550	s/sec=966.12 tok/sec=28731.16 u/sec=4.96	ppl=84.402772 
