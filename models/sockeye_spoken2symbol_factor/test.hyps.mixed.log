[2021-12-17:13:07:54:INFO:sockeye.utils:log_sockeye_version] Sockeye: 3.0.4, commit 8e5033be2a2f09d935c682f33703eff34cf8b3f4, path /home/cluster/zifjia/.local/lib/python3.8/site-packages/sockeye/__init__.py
[2021-12-17:13:07:54:INFO:sockeye.utils:log_mxnet_version] MXNet: 2.0.0 (/home/cluster/zifjia/.local/lib/python3.8/site-packages/mxnet/__init__.py)
[2021-12-17:13:07:54:INFO:sockeye.utils:log_torch_version] PyTorch: 1.10.0+cu102 (/home/cluster/zifjia/.local/lib/python3.8/site-packages/torch/__init__.py)
[2021-12-17:13:07:54:INFO:sockeye.utils:log_basic_info] Command: /home/cluster/zifjia/.local/lib/python3.8/site-packages/sockeye/translate.py --models models/sockeye_spoken2symbol_factor --input data_reverse/test.spm.spoken --output models/sockeye_spoken2symbol_factor/test.hyps.symbol --max-input-length 99999 --beam-size 3 --device-id 0 --disable-device-locking --seed 42 --output-type translation_with_factors
[2021-12-17:13:07:54:INFO:sockeye.utils:log_basic_info] Arguments: Namespace(avoid_list=None, batch_size=1, beam_search_stop='all', beam_size=3, brevity_penalty_constant_length_ratio=0.0, brevity_penalty_type='none', brevity_penalty_weight=1.0, bucket_width=10, checkpoints=None, chunk_size=None, config=None, device_id=0, device_ids=[-1], disable_device_locking=True, dtype=None, ensemble_mode='linear', env=None, greedy=False, input='data_reverse/test.spm.spoken', input_factors=None, json_input=False, length_penalty_alpha=1.0, length_penalty_beta=0.0, lock_dir='/tmp', loglevel='INFO', loglevel_secondary_workers='INFO', max_input_length=99999, max_output_length=None, max_output_length_num_stds=2, mc_dropout=False, models=['models/sockeye_spoken2symbol_factor'], nbest_size=1, no_hybridization=False, no_logfile=False, output='models/sockeye_spoken2symbol_factor/test.hyps.symbol', output_type='translation_with_factors', prevent_unk=False, quiet=False, quiet_secondary_workers=False, restrict_lexicon=None, restrict_lexicon_topk=None, sample=None, seed=42, softmax_temperature=None, strip_unknown_words=False, use_cpu=False)
[2021-12-17:13:07:54:WARNING:sockeye.utils:expand_requested_device_ids] Sockeye currently does not respect CUDA_VISIBLE_DEVICE settings when locking GPU devices.
[2021-12-17:13:07:54:INFO:sockeye.utils:_expand_requested_device_ids] Attempting to acquire 1 GPUs of 1 GPUs.
[2021-12-17:13:07:54:INFO:__main__:run_translate] Translate Device: gpu(0)
[2021-12-17:13:07:54:INFO:sockeye.model:load_models] Loading 1 model(s) from ['models/sockeye_spoken2symbol_factor'] ...
[2021-12-17:13:07:54:INFO:sockeye.vocab:vocab_from_json] Vocabulary (2000 words) loaded from "models/sockeye_spoken2symbol_factor/vocab.src.0.json"
[2021-12-17:13:07:54:INFO:sockeye.vocab:vocab_from_json] Vocabulary (12216 words) loaded from "models/sockeye_spoken2symbol_factor/vocab.trg.0.json"
[2021-12-17:13:07:54:INFO:sockeye.vocab:vocab_from_json] Vocabulary (400 words) loaded from "models/sockeye_spoken2symbol_factor/vocab.trg.1.json"
[2021-12-17:13:07:54:INFO:sockeye.vocab:vocab_from_json] Vocabulary (464 words) loaded from "models/sockeye_spoken2symbol_factor/vocab.trg.2.json"
[2021-12-17:13:07:54:INFO:sockeye.model:load_model] Model version: 3.0.4
[2021-12-17:13:07:54:INFO:sockeye.model:load_config] Loaded model config from "models/sockeye_spoken2symbol_factor/config"
[2021-12-17:13:07:54:INFO:sockeye.model:load_model] Disabling dropout layers for performance reasons
[2021-12-17:13:07:54:INFO:sockeye.model:__init__] ModelConfig(config_data=DataConfig(data_statistics=DataStatistics(num_sents=111496, num_discarded=449, num_tokens_source=2089428, num_tokens_target=2224742, num_unks_source=0, num_unks_target=0, max_observed_len_source=200, max_observed_len_target=201, size_vocab_source=2000, size_vocab_target=12216, length_ratio_mean=1.2299938397751786, length_ratio_std=2.141218992882336, buckets=[(8, 8), (16, 16), (24, 24), (32, 32), (40, 40), (48, 48), (56, 56), (64, 64), (72, 72), (80, 80), (88, 88), (96, 96), (104, 104), (112, 112), (120, 120), (128, 128), (136, 136), (144, 144), (152, 152), (160, 160), (168, 168), (176, 176), (184, 184), (192, 192), (200, 200), (201, 201)], num_sents_per_bucket=[0, 71871, 14120, 2192, 2442, 2532, 2304, 2309, 2080, 1627, 1322, 1347, 1227, 1137, 1029, 940, 750, 568, 508, 371, 272, 218, 150, 97, 73, 10], average_len_target_per_bucket=[None, 7.689763604235408, 10.600283286118982, 12.317062043795627, 12.51719901719903, 14.048973143759865, 20.44618055555557, 30.847986141186613, 42.984134615384626, 57.08789182544553, 73.79500756429661, 86.85523385300668, 96.0081499592501, 105.33245382585751, 114.88824101068995, 121.16170212765964, 129.3133333333335, 136.60387323943652, 146.009842519685, 152.1401617250672, 158.88970588235284, 169.4495412844037, 173.20666666666668, 182.4123711340206, 183.12328767123287, 201.0], length_ratio_stats_per_bucket=[(None, None), (0.5766197022959187, 0.22452754830872645), (0.6511640959312952, 0.4415644165320494), (0.635950183596026, 0.699427270745044), (0.5526311513147323, 0.8145420619137541), (0.618830317554716, 1.045323539582466), (1.0331827068431514, 1.5366608236826946), (1.630689629039961, 1.9308594211961128), (2.3895150201033246, 2.290141525591634), (3.2612951670698984, 2.520448327222355), (4.241565830174328, 2.502477741619932), (5.19077997236954, 2.5249255743519408), (5.556198112389078, 2.685502038493293), (6.013177557403562, 2.86841039193869), (6.703045064335855, 2.9841554012653306), (7.2296040307761364, 3.2397589449693966), (7.463475802730482, 3.487340002098098), (8.117606890726098, 3.6789541569386794), (8.363010735301984, 3.9616131958045164), (8.520977478714071, 4.201769162101354), (8.896383527111286, 4.4914463868524725), (10.036496433653424, 4.458607729472426), (10.616517432260554, 4.716215100936051), (11.064394202394423, 4.985450950125323), (11.334233439352515, 5.6348994951220845), (10.425639801187467, 5.625230140709965)]), max_seq_len_source=201, max_seq_len_target=201, num_source_factors=1, num_target_factors=3), vocab_source_size=2000, vocab_target_size=12216, config_embed_source=EmbeddingConfig(vocab_size=2000, num_embed=512, dropout=0.0, num_factors=1, factor_configs=None, allow_sparse_grad=False), config_embed_target=EmbeddingConfig(vocab_size=12216, num_embed=512, dropout=0.0, num_factors=3, factor_configs=[FactorConfig(vocab_size=400, num_embed=32, combine='concat', share_embedding=False), FactorConfig(vocab_size=464, num_embed=32, combine='concat', share_embedding=False)], allow_sparse_grad=False), config_encoder=TransformerConfig(model_size=512, attention_heads=8, feed_forward_num_hidden=2048, act_type='relu', num_layers=6, dropout_attention=0.0, dropout_act=0.0, dropout_prepost=0.0, positional_embedding_type='fixed', preprocess_sequence='n', postprocess_sequence='dr', max_seq_len_source=201, max_seq_len_target=201, decoder_type='transformer', use_lhuc=False, depth_key_value=512, use_glu=False), config_decoder=TransformerConfig(model_size=576, attention_heads=8, feed_forward_num_hidden=2048, act_type='relu', num_layers=6, dropout_attention=0.0, dropout_act=0.0, dropout_prepost=0.0, positional_embedding_type='fixed', preprocess_sequence='n', postprocess_sequence='dr', max_seq_len_source=201, max_seq_len_target=201, decoder_type='transformer', use_lhuc=False, depth_key_value=512, use_glu=False), config_length_task=None, weight_tying_type='none', lhuc=False, dtype='float32')
[2021-12-17:13:08:03:INFO:sockeye.model:load_model] Model dtype: float32
[2021-12-17:13:08:04:INFO:sockeye.model:load_parameters] Loaded params from "models/sockeye_spoken2symbol_factor/params.best" to "gpu(0)"
[2021-12-17:13:08:04:INFO:sockeye.model:load_models] 1 model(s) loaded in 9.5764s
[2021-12-17:13:08:04:INFO:sockeye.inference:__init__] Translator (1 model(s) beam_size=3 algorithm=BeamSearch, beam_search_stop=all max_input_length=200 nbest_size=1 ensemble_mode=None max_batch_size=1 avoiding=0 dtype=float32 softmax_temperature=None)
[2021-12-17:13:08:04:INFO:__main__:read_and_translate] Translating...
[2021-12-17:13:19:35:INFO:__main__:read_and_translate] Processed 1143 lines. Total time: 690.6421, sec/sent: 0.6042, sent/sec: 1.6550
