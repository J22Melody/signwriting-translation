[2023-11-22:17:44:30:INFO:sockeye.utils:log_sockeye_version] Sockeye: 3.1.37, commit unknown, path /home/zifjia/sockeye_aws/sockeye/__init__.py
[2023-11-22:17:44:30:INFO:sockeye.utils:log_torch_version] PyTorch: 1.13.1+cu117 (/home/zifjia/data/conda/envs/signbank+/lib/python3.9/site-packages/torch/__init__.py)
[2023-11-22:17:44:30:INFO:sockeye.utils:log_basic_info] Command: /home/zifjia/sockeye_aws/sockeye/translate.py --models models_new/expanded --input data_new_expanded/test.sign --input-factors data_new_expanded/test.feat_x data_new_expanded/test.feat_y data_new_expanded/test.feat_x_rel data_new_expanded/test.feat_y_rel data_new_expanded/test.sign+ data_new_expanded/test.feat_col data_new_expanded/test.feat_row --output models_new/expanded/test.hyps.spm.spoken --max-input-length 99999 --beam-size 5 --device-id 0 --brevity-penalty-type constant --seed 42
[2023-11-22:17:44:30:INFO:sockeye.utils:log_basic_info] Arguments: Namespace(config=None, input='data_new_expanded/test.sign', input_factors=['data_new_expanded/test.feat_x', 'data_new_expanded/test.feat_y', 'data_new_expanded/test.feat_x_rel', 'data_new_expanded/test.feat_y_rel', 'data_new_expanded/test.sign+', 'data_new_expanded/test.feat_col', 'data_new_expanded/test.feat_row'], json_input=False, output='models_new/expanded/test.hyps.spm.spoken', models=['models_new/expanded'], checkpoints=None, nbest_size=1, beam_size=5, greedy=False, beam_search_stop='all', batch_size=1, chunk_size=None, sample=None, seed=42, ensemble_mode='linear', bucket_width=10, max_input_length=99999, max_output_length_num_stds=2, max_output_length=None, restrict_lexicon=None, restrict_lexicon_topk=None, skip_nvs=False, nvs_thresh=0.5, strip_unknown_words=False, prevent_unk=False, output_type='translation', length_penalty_alpha=1.0, length_penalty_beta=0.0, brevity_penalty_type='constant', brevity_penalty_weight=1.0, brevity_penalty_constant_length_ratio=0.0, dtype=None, clamp_to_dtype=False, device_id=0, use_cpu=False, env=None, tf32=True, quiet=False, quiet_secondary_workers=False, no_logfile=False, loglevel='INFO', loglevel_secondary_workers='INFO', knn_index=None, knn_lambda=0.8)
[2023-11-22:17:44:31:INFO:sockeye.utils:init_device] CUDA: allow tf32 (float32 but with 10 bits precision)
[2023-11-22:17:44:31:INFO:__main__:run_translate] Translate Device: cuda:0
[2023-11-22:17:44:31:INFO:sockeye.model:load_models] Loading 1 model(s) from ['models_new/expanded'] ...
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (15608 words) loaded from "models_new/expanded/vocab.src.0.json"
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (432 words) loaded from "models_new/expanded/vocab.src.1.json"
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (472 words) loaded from "models_new/expanded/vocab.src.2.json"
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (64 words) loaded from "models_new/expanded/vocab.src.3.json"
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (56 words) loaded from "models_new/expanded/vocab.src.4.json"
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (760 words) loaded from "models_new/expanded/vocab.src.5.json"
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (16 words) loaded from "models_new/expanded/vocab.src.6.json"
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (24 words) loaded from "models_new/expanded/vocab.src.7.json"
[2023-11-22:17:44:31:INFO:sockeye.vocab:vocab_from_json] Vocabulary (4312 words) loaded from "models_new/expanded/vocab.trg.0.json"
[2023-11-22:17:44:31:INFO:sockeye.model:load_model] Model version: 3.1.37
[2023-11-22:17:44:31:INFO:sockeye.model:load_config] Loaded model config from "models_new/expanded/config"
[2023-11-22:17:44:31:INFO:sockeye.model:__init__] ModelConfig(config_data=DataConfig(data_statistics=DataStatistics(num_sents=1024500, num_discarded=2, num_tokens_source=10901580, num_tokens_target=5164216, num_unks_source=0, num_unks_target=0, max_observed_len_source=96, max_observed_len_target=196, size_vocab_source=15608, size_vocab_target=4312, length_ratio_mean=0.5186323896452135, length_ratio_std=0.3554390833055887, buckets=[(8, 8), (16, 16), (24, 24), (32, 32), (40, 40), (48, 48), (56, 56), (64, 64), (72, 72), (80, 80), (88, 88), (96, 96), (104, 104), (112, 112), (120, 120), (128, 128), (136, 136), (144, 144), (152, 152), (160, 160), (168, 168), (176, 176), (184, 184), (192, 192), (200, 200), (201, 201)], num_sents_per_bucket=[432379, 523990, 42682, 5826, 2938, 2287, 2213, 2780, 3025, 2882, 2578, 821, 30, 13, 8, 10, 10, 6, 1, 6, 2, 4, 3, 2, 4, 0], average_len_target_per_bucket=[4.135334972327465, 4.828063512662262, 6.719319619511736, 10.901819430140748, 15.063989108236939, 19.350240489724552, 21.124265702666065, 23.9830935251798, 27.085289256198276, 29.634281748785504, 32.692785104732316, 36.42265529841655, 100.43333333333332, 108.6923076923077, 116.25, 125.0, 132.10000000000002, 140.83333333333331, 148.0, 155.5, 162.5, 172.0, 180.33333333333334, 188.5, 194.5, None], length_ratio_stats_per_bucket=[(0.5743623539489789, 0.20104410991666757), (0.47035279153532145, 0.27928194684761937), (0.4412524134371495, 0.5539074058401151), (0.6966882124391869, 1.084042180233606), (0.8326263581144604, 1.3483938006916854), (0.9673584898436735, 1.5824764061641485), (0.6466763175948788, 1.1761397022444244), (0.5263895420628171, 0.8972160157748982), (0.49829128091250935, 0.9283455282499427), (0.509314659994052, 1.0776079585192622), (0.49088849177952265, 1.0571204269381713), (0.6757536295125441, 1.6419251974397497), (9.39581347857291, 3.2462817357485196), (8.822836591719108, 4.477978162406543), (10.956883330485304, 3.292236881457392), (9.332937638135423, 5.926444735884293), (15.34, 4.717874275476605), (15.866666666666667, 2.7801253968521316), (24.666666666666668, 0.0), (17.358405483405484, 4.273141659431777), (25.154761904761905, 2.0119047619047628), (19.82638888888889, 1.8016116113491685), (24.100288600288604, 5.78348398763817), (25.232142857142858, 1.4821428571428577), (22.041666666666664, 5.958333333333335), (None, None)]), max_seq_len_source=201, max_seq_len_target=201, num_source_factors=8, num_target_factors=1, eop_id=-1), vocab_source_size=15608, vocab_target_size=4312, config_embed_source=EmbeddingConfig(vocab_size=15608, num_embed=512, dropout=0.5, num_factors=8, factor_configs=[FactorConfig(vocab_size=432, num_embed=16, combine='concat', share_embedding=False), FactorConfig(vocab_size=472, num_embed=16, combine='concat', share_embedding=False), FactorConfig(vocab_size=64, num_embed=16, combine='concat', share_embedding=False), FactorConfig(vocab_size=56, num_embed=16, combine='concat', share_embedding=False), FactorConfig(vocab_size=760, num_embed=16, combine='concat', share_embedding=False), FactorConfig(vocab_size=16, num_embed=16, combine='concat', share_embedding=False), FactorConfig(vocab_size=24, num_embed=16, combine='concat', share_embedding=False)], allow_sparse_grad=False), config_embed_target=EmbeddingConfig(vocab_size=4312, num_embed=512, dropout=0.5, num_factors=1, factor_configs=None, allow_sparse_grad=False), config_encoder=TransformerConfig(model_size=624, attention_heads=8, feed_forward_num_hidden=2048, act_type='relu', num_layers=6, dropout_attention=0.5, dropout_act=0.1, dropout_prepost=0.1, positional_embedding_type='fixed', preprocess_sequence='n', postprocess_sequence='dr', max_seq_len_source=201, max_seq_len_target=201, decoder_type='transformer', block_prepended_cross_attention=False, use_lhuc=False, depth_key_value=624, use_glu=False), config_decoder=TransformerConfig(model_size=512, attention_heads=8, feed_forward_num_hidden=2048, act_type='relu', num_layers=6, dropout_attention=0.5, dropout_act=0.1, dropout_prepost=0.1, positional_embedding_type='fixed', preprocess_sequence='n', postprocess_sequence='dr', max_seq_len_source=201, max_seq_len_target=201, decoder_type='transformer', block_prepended_cross_attention=False, use_lhuc=False, depth_key_value=624, use_glu=False), config_length_task=None, weight_tying_type='trg_softmax', lhuc=False, dtype='float32', neural_vocab_selection=None, neural_vocab_selection_block_loss=False)
[2023-11-22:17:44:37:INFO:sockeye.model:load_parameters] Loaded params from "models_new/expanded/params.best" to "cuda:0"
[2023-11-22:17:44:37:INFO:sockeye.model:load_model] Model dtype: torch.float32
[2023-11-22:17:44:37:INFO:sockeye.model:load_models] 1 model(s) loaded in 6.2792s
[2023-11-22:17:44:37:INFO:__main__:run_translate] Using average of constant length ratios saved in the model configs: 0.518632
[2023-11-22:17:44:37:INFO:sockeye.inference:__init__] Translator (1 model(s) beam_size=5 algorithm=BeamSearch, beam_search_stop=all max_input_length=200 nbest_size=1 ensemble_mode=None max_batch_size=1 dtype=torch.float32 skip_nvs=False nvs_thresh=0.5)
[2023-11-22:17:44:37:INFO:__main__:read_and_translate] Translating...
[2023-11-22:17:47:19:INFO:__main__:read_and_translate] Processed 568 lines. Total time: 161.8967, sec/sent: 0.2850, sent/sec: 3.5084
